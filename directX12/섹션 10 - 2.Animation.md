물체에 애니메이션을 넣어주기 위해
skinnig : 살이 뼈대에 붙어서 움직인다. 뼈대가 움직인것을 메쉬들이 따라 움직인다.
각 뼈들의 좌표계의 중심은 관절이다.

계층구조라서 재귀함수를 많이 사용한다.
예를 들어 손가락의 월드 스페이스를 구하고 싶다면 손가락의 부모(손) 변환 매트릭스를 곱하고 그의 부모 변환 매트릭스를 또 곱하고 ... 루트까지 곱해서 그 루트의 월드변환 매트릭스를 곱해서 월드 좌표를 구할 수 있다.

월드 좌표로 정읮되어 있던 애니메이션과 관련된 연산을 하기 위해서는 각 관절에 대한 로컬 메쉬 좌표를 가져야 한다. 관절에 대한 좌표를 얻어 애니메이션을 수행 후 다시 월드로 변환한다.
bind position -> local bone position : offset 변환 이라 한다.

offset 변환 후 애니메이션 적용 (뼈대에 따라 자연스럽게 메쉬 이동) 후 다시 월드로 변?? 인지 정확하게 뭔지 모르겠음 

관절이 움직임에 따라 메쉬도 자연스럽게 따라 움직여야 한다.
한  정점의 움직임에 영향을 주는 관절이 여러개 있을 수 있다. 우리의 프로젝트에서는 최대 4개로 제한한다.

자연스러운 움직임을 위해 각 프레임에서 시간이 지날때마다 다음 위치로 시간엗 ㅐ한 비율을 이용해 자연스럽게 마든다.

# FBXLoader
애니메이션 관련 코드들을 사용한다.

![[Pasted image 20230918173631.png]]
- final matrix 는 결국 키프레임이라 봐도 될듯


EvaluateGlobalTransform() 함수가 느리게 작동함
만약 우리가 실제 게임 엔진을 구현한다면 이 부분을 직접 만들어서 더 빠르게 작동할 수 있도록 해야 한다.
# Animator

# Mesh


# StructuredBuffer
# Shader 추가
Skinning
- 여태 구한 toParrent, toRoot 행렬을 이용해서 각 본 마다의 ratio를 참고해서 애니메이션된 정점의 좌표를 구한다.

# Resources
애니메이션과 관련된 셰이더 코드를 작성했기 때문에 이를 사용하기 위해서 resource로 만들어 사용한다. compute animation



무식한 방법으로 toParrent를 구해서 느린거임

나중에 진짜 포폴 만들라면
mesh, material, animation, bone 과 관련된 정보를 별도의 파일로 추출할 수 있게 Load, Save 를 구현해야 한다.